<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ورود به چت خصوصی</title>
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="fonts/IranSansX/fontiran.css" />
  <style>
    body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
    .card { max-width: 480px; margin: 100px auto; }
    .input-group-text { cursor: pointer; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card shadow-lg">
      <div class="card-body p-5">
        <h3 class="text-center mb-4">چت با داده‌های خصوصی شما</h3>
        <div class="mb-3">
          <label class="form-label">کلید اختصاصی (حداقل ۱۶ کاراکتر)</label>
          <div class="input-group">
            <input type="password" id="userKey" class="form-control form-control-lg" placeholder="کلید خود را وارد کنید" />
            <span class="input-group-text" id="togglePass">نمایش</span>
          </div>
        </div>
        <div class="d-flex gap-2">
          <button id="enterBtn" class="btn btn-primary flex-fill">ورود</button>
          <button id="generateBtn" class="btn btn-outline-secondary">تولید کلید جدید</button>
        </div>
        <div class="mt-3 text-center">
          <small class="text-muted">این کلید را ذخیره کنید. بدون آن دسترسی به داده‌هایتان ممکن نیست.</small>
        </div>
      </div>
    </div>
  </div>

  <script>
    const userKeyInput = document.getElementById("userKey");
    const togglePass = document.getElementById("togglePass");
    const generateBtn = document.getElementById("generateBtn");
    const enterBtn = document.getElementById("enterBtn");

    togglePass.addEventListener("click", () => {
      const type = userKeyInput.type === "password" ? "text" : "password";
      userKeyInput.type = type;
      togglePass.textContent = type === "password" ? "نمایش" : "مخفی";
    });

    generateBtn.addEventListener("click", () => {
      const chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let key = "";
      for (let i = 0; i < 24; i++) {
        key += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      userKeyInput.value = key;
      userKeyInput.type = "text";
      togglePass.textContent = "مخفی";
    });

    enterBtn.addEventListener("click", () => {
      const key = userKeyInput.value.trim();
      if (key.length < 16) {
        alert("کلید باید حداقل ۱۶ کاراکتر باشد");
        return;
      }
      window.location.href = `/rag.html?key=${encodeURIComponent(key)}`;
    });

    userKeyInput.addEventListener("keypress", e => {
      if (e.key === "Enter") enterBtn.click();
    });
  </script>
</body>
</html>